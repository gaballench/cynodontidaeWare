begin mrbayes;
[Script documentation carried out using comments]

[log the analysis]
log start filename = cynoMolmorph.log;
[read the matrix concatenatedMolmorph.nexus]
execute concatenatedMolmorph.nexus;

[close analysis at end]
set autoclose = yes;
[set Acestrorhynchus_microlepis as outgroup]
outgroup Acestrorhynchus_microlepis;
[This command shows the status of all the taxa, according to the documentation]
taxastat;

[definition of individual partitions per marker]
charset 16S = 1-588;
charset 18S = 589-1176;
charset ATPase6_8 = 1177-1959;
charset COI = 1960-2464;
charset CytB = 2465-3301;
charset Myh6 = 3302-4044;
charset RAG1 = 4045-5309;
charset RAG2 = 5310-6322;
charset morph = 6323-6405;

[definition of combined dataset]
partition combined = 8: 16S, 18S, ATPase6_8, COI, CytB, Myh6, RAG1, RAG2,  morph;

[specification of substitution models]
set partition = combined;
lset applyto = (1) nst = 6 rates = propinv; [SYM+I]
lset applyto = (2) nst = 6 rates = propinv; [SYM+I]
lset applyto = (3) nst = 2 rates = propinv; [HKY+I]
lset applyto = (4) nst = 2 rates = gamma; [HKY+G]
lset applyto = (5) nst = 2 rates = propinv; [HKY+I]
lset applyto = (6) nst = 2; [K80]
lset applyto = (7) nst = 2; [K80]
lset applyto = (8) nst = 2; [K80]
lset applyto = (9) coding = variable; [Lewis2001 model]

[unlink parameters across partitions]
unlink shape = (all) pinvar = (all) statefreq = (all) revmat = (all) tratio = (all);

[allow separate gamma parameters for each partition]
prset applyto=(all) ratepr=variable;

[show the model just specified for each partition]
showmodel;

[set up the MCMC, with this setting the analysis will need not less than 16 threads]
mcmcp nruns = 2 ngen = 4000000 nchains = 8 samplefreq = 4000 printfreq = 100;
[run the MCMC]
mcmc;

[summarize the posterior trees]
sumt nruns = 2 relburnin = yes burninfrac = 0.25;
plot;

[summarize parameter posteriors]
sump;

log stop;
end;